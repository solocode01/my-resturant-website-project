{% load static extra %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="shortcut icon"
      href="{% static 'images/my logo short new.png' %}"
      type="image/x-icon"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link rel="stylesheet" href="{% static "css/style.css" %}" />
    <link rel="stylesheet" href="{% static "css/cart.css" %}">
    <link rel="stylesheet" href="{% static "css/checkout.css" %}">

    <title>{% block title %}{% endblock %}</title>
  </head>

  <body>
    <!-- start header-->
    <header>
      <div class="header">
        <div class="headerbar">
          <div class="account">
            <ul>
                {% if request.user.is_authenticated %}
                <a href="#">
                  <li class="user_details">
                    <i class="fa-solid fa-user" id="user-lap"></i>
                    <button class="username name">{{ request.user.username }}</button>
                    <button class="username logout"><a href="{% url "logout" %}"> Logout </a></button>
                  </li>
                  {% else %}
                  <li class="user_details">
                    <i class="fa-solid fa-user" id="user-lap"></i>
                    <button class="username name"><a href="{% url "login" %}">Login</a></button>
                    <button class="username logout"><a href="{% url "register" %}"> Register </a></button>
                  </li>
                  {% endif %}
                </a>
              <a href="#">
                <li>
                  <i
                    class="fa-solid fa-magnifying-glass searchicon"
                    id="searchicon1"
                  ></i>
                </li>
              </a>
              <div class="search" id="searchinput1">
                <input type="search" />
                <i class="fa-solid fa-magnifying-glass srchicon"></i>
              </div>
              <li class="shopping_cart">
                <a href="{% url "cart" %}">
                    <i class="fas fa-shopping-cart"></i>
                </a>
                <sup id="item">{% if total %} {{ total }} {% else %} {% get_cart_count %} {% endif %} </sup>
              </li>
  
            </ul>
          </div>
          <div class="nav">
            <ul>
              <li class="current"><a href="{% url "home" %}">Home</a></li>
              <li><a href="{% url "about" %}">About</a></li>
              <li><a href="{% url "menu" %}">Food Menu</a></li>
            </ul>
          </div>
        </div>
        <div class="logo">
          <a href="{% url "home" %}"><img src="{% static 'images/My Logo Wide.png' %}" alt="" /></a>
        </div>
        <div class="bar">
          <i class="fa-solid fa-bars"></i>
          <i class="fa-solid fa fa-xmark" id="hdcross"></i>
        </div>
        <div class="nav"> 
          <ul>
            <li class="{% if home %} current {% endif %}"><a href="{% url "home" %}">Home</a></li>
            <li class="{% if about %} current {% endif %}"><a href="{% url "about" %}">About</a></li>
            <li class="{% if food_menu %} current {% endif %}"><a href="{% url "menu" %}">Food Menu</a></li>
          </ul>
        </div>
        <div class="account">
          <ul>
            {% if request.user.is_authenticated %}
            <a href="#">
              <li class="user_details">
                <i class="fa-solid fa-user" id="user-lap"></i>
                <button class="username name">{{ request.user.username }}</button>
                <button class="username logout"><a href="{% url "logout" %}"> Logout </a></button>
              </li>
              {% else %}
              <li class="user_details">
                <i class="fa-solid fa-user" id="user-lap"></i>
                <button class="username name"><a href="{% url "login" %}">Login</a></button>
                <button class="username logout"><a href="{% url "register" %}"> Register </a></button>
              </li>
              {% endif %}
            </a>

            <a href="#">
              <li>
                <i
                  class="fa-solid fa-magnifying-glass searchicon"
                  id="searchicon2"
                ></i>
              </li>
            </a>
            <div class="search" id="searchinput2">
              <input type="search" />
              <i class="fa-solid fa-magnifying-glass srchicon"></i>
            </div>
            <li class="shopping_cart">
              <a href="{% url "cart" %}">
                  <i class="fas fa-shopping-cart"></i>
              </a>
              <sup id="item">{% if total %} {{ total }} {% else %} {% get_cart_count %} {% endif %} </sup>
            </li>
          </ul>
        </div>
      </div>
    </header>
    {% if messages %}
    <div style="display: flex; justify-content: center; background-color: white; ">
      {% for message in messages  %}
      <ul id='mes'>
          <li class="{% if message.tags %} alert alert-{{ message.tags}} {% endif %}"> {{message}} </li>
      </ul>
      {% endfor %}
    </div>
  {% endif %}


<div class="home">
  <div class="main_slide">
    <div>
      <h1>Enjoy <span>Delicious Food</span> in Your Healthy Life.</h1>
      <p>
        Welcome to Solomon's Cuisine, where culinary artistry meets cultural
        fusion. Explore our delectable menu, crafted with passion and
        precision, and embark on a journey of gastronomic delight.
      </p>

      <button class="red_btn">
        <a href="{% url "menu" %}"
          >Visit Now <i class="fa-solid fa-arrow-right-long"></i
        ></a>
      </button>
    </div>
    <div>
      <img src="{% static 'images/plate3.png' %}" id="image" />
    </div>
  </div>

  <div class="food-items">  
    <div class="item">
      <div>
        <img src="{% static 'images/item1.png' %}" alt="food item" />
      </div>
      <h3>Jollof Rice</h3>
      <p>
        Indulge in a culinary masterpiece, crafted with love and expertise.
      </p>
      <button class="white_btn"><a href="#">See Menu</a></button>
    </div>
    <div class="item">
      <div>
        <img src="{% static 'images/item2.png' %}" alt="food item" />
      </div>
      <h3>Snacks</h3>
      <p>Savour the symphony of flavours in each succulent bite. Yummy!</p>
      <button class="red_btn"><a href="#">See Menu</a></button>
    </div>
    <div class="item">
      <div>
        <img src="{% static 'images/item3.png' %}" alt="food item" />
      </div>
      <h3>Grilled Fish</h3>
      <p>
        Exotic spices dance on your palate, igniting culinary adventures
      </p>
      <button class="white_btn"><a href="#">See Menu</a></button>
    </div>
  </div>

  <div class="main_slide2">
    <div class="foodimg">
      <img src="{% static 'images/home img.png' %}" alt="" />
    </div>
    <div class="question">
      <div>
        <h2>Why People Choose Us?</h2>
      </div>
      <div>
        <div class="q-ans">
          <div>
            <img src="{% static 'images/plate2.png' %}" alt="" />
          </div>
          <div>
            <h4>Great Food</h4>
            <p>
              We offer delicious flavourful dishes, using fresh ingredients
              and skilled preparation techniques.
            </p>
          </div>
        </div>
        <div class="q-ans">
          <div>
            <img src="{% static 'images/plate3.png' %}" alt="" />
          </div>
          <div>
            <h4>Excellent Service</h4>
            <p>
              Friendly and attentive staff who provide efficient service,
              making customers feel welcomed and well taken care of.
            </p>
          </div>
        </div>
        <div class="q-ans">
          <div>
            <img src="{% static 'images/plate4 (2).png' %}" alt="" />
          </div>
          <div>
            <h4>Pleasant Ambiance</h4>
            <p>A comfortable and enjoyable environemnt for patrons.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="main_slide3">
    <div class="fav-head">
      <h3>Our Popular Food Items</h3>
      <p>
        Embark on a culinary journey with Solomon's Cuisine, where each dish
        tells a story of tradition, innovation, and flavour. From
        tantalizing appetizers to mouthwatering entrees, experience
        unforgettable dinning moments with us.
      </p>
    </div>
    {% if popular_menu %}
    <div class="fav-food">
      {% for menus in popular_menu  %}
        <div class="item" data-id="{{ menus.id }}">
          <div>
            <img
              src="{{ menus.image.url }}"
              alt=""
            />
          </div>
          <h3>{{ menus.name }}</h3>
          <p>
            {{ menus.description }}
          </p>
          <p class="fav-price">N{{ menus.price }} </p>
          {% csrf_token %}
          <input type="hidden" value="{{ menus.name }}" id="itemid">
          <button class="add-to-cart">Add to Cart</button>
        </div>
      {% endfor %}
      {% comment %} <div class="item">
        <div>
          <img
            src="{% static 'images/Efo riro (Nigerian Spinach stew recipe).jpeg' %}"
            alt=""
          />
        </div>
        <h3>Vegetable Soup</h3>
        <p>
          Savour the symphony of flavours in each succulent bite. Yummy!
        </p>
        <p class="fav-price">N2,500</p>
      </div>
      <div class="item">
        <div>
          <img src="{% static 'images/home img.png' %}" alt="" />
        </div>
        <h3>Pounded Yam</h3>
        <p>
          Exotic spices dance on your palate, igniting culinary adventures
        </p>
        <p class="fav-price">N2,000</p>
      </div>
      <div class="item">
        <div>
          <img src="{% static 'images/Indomie and Egg.jpeg' %}" alt="" />
        </div>
        <h3>Indomie and Egg</h3>
        <p>Taste the essence of tradition infused with modern gastronomy</p>
        <p class="fav-price">N2,500</p>
      </div> {% endcomment %}
    </div>
    
    <div class="dsgn"></div>
    {% else %}
    <div class="fav-food">
      <div class="item">
        <div>
          <img src="{% static 'images/home img.png' %}" alt="" />
        </div>
        <h3>Pounded Yam</h3>
        <p>
          Exotic spices dance on your palate, igniting culinary adventures
        </p>
        <p class="fav-price">N2,000</p>
      </div>
    </div>
    {% endif %}
  </div>

  <div class="main_slide4">
    <div class="chef-feed">
      <h2>Customer <span style="color: red">Feedback</span></h2>
      <p>
        Solomon's Cuisine surpassed all my expectations, creating an
        unforgettable dining experience. From the moment I entered, I was
        embraced by warmth and hospitality, setting the tone for a memorable
        evening. The ambiance was inviting, with subtle lighting and
        soothing music, creating the perfect atmosphere for indulgence. The
        aroma of spices tantalized my senses, fortelling the culinary
        delights to come. Each dish was a masterpiece, meticulouly crafted
        with the finest ingredients and bursting with flavour. The attentive
        staff guided me through the menu, offering recommendations with
        enthusiasm and expertise. Their passion for food was evident in
        every detail, from presentation to taste. As I left, fully satisfied
        and content, I couldn't help but plan my next visit. Thank you,
        Solomon's Cuisine, for an exquisite journey thaht will linger in my
        memory for years to come!
      </p>
      <div class="chef-detail">
        <div>
          <img src="{% static 'images/my logo short.png' %}" alt="" />
        </div>
        <div>
          <h6>Solo Dev</h6>
          <p>Web Developer</p>
        </div>
      </div>
      <div class="chef-vic">
        <div>
          <i class="fa-solid fa-hand-peace"></i>
          <h4>68</h4>
          <p>Lorem ipsum dolor sit amet.</p>
        </div>
        <div>
          <i class="fa-solid fa-trophy"></i>
          <h4>956</h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing.</p>
        </div>
      </div>
    </div>
    <div class="chef">
      <img src="{% static 'images/Chef new.png' %}" alt="" />
    </div>
  </div>

  <div class="letter">
    <div class="letter-head">
      <h2>Subscribe <span>Newsletter</span></h2>
    </div>
    <div class="letter-input">
      <div>
        <input type="email" placeholder="Example.com" />
      </div>
      <button class="red_btn">Subscribe</button>
    </div>
  </div>
</div>

<script>
  mes = document.getElementById('mes');

  setTimeout(function(){
      mes.style.display = "none";
  }, 5000)
</script>

<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    let csrf_token = document.getElementsByName("csrfmiddlewaretoken")[0].value;
    let buttons = document.querySelectorAll(".add-to-cart");

    buttons.forEach(function(button) {
        button.addEventListener("click", function(e) {
            e.preventDefault();

            let item = this.closest(".item");
            let itemID = item.getAttribute("data-id");

            if (!itemID) {
                alert("Item ID is required.");
                return;
            }

            let data = {
                "id": itemID,
            };

            console.log(data);

            $.ajax({
                type: "POST",
                url: "/add_to_cart/",
                dataType: "json",
                data: data,
                cache: false, // Prevent caching issues
                beforeSend: function(xhr) {
                    xhr.setRequestHeader("X-CSRFToken", csrf_token);
                },
                success: function(res) {
                    alert(res.msg);
                    console.log(res);
                    let cartCountElement = document.getElementById("item");
                    console.log(res.total)
                    if (cartCountElement) {
                        cartCountElement.textContent = res.total;
                    }
                },
                error: function(err) {
                    alert("Error: " + (err.responseText || "An error occurred."));
                    console.log(err);
                }
            });
        });
    });
});


</script>

  <!-- start footer -->
  {% include "components/footer.html" %}
  <!-- end footer -->

  <script src="{% static 'js/app.js' %}"></script>
</body>
</html>
